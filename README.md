# devman-review-alerts
 
## Что потребуется
- Учиться на [курсах Девмана](https://dvmn.org/modules/). 
- Сервер на линуксе.

### Переменные для .env
1. Сохрани файлы из репозитория на своём компьютере. Создай файл .env в корневом каталоге проекта.
2. Cookies из браузера для авторизации на Девмане: 
   1. Зайди на страницу любого урока и открой вкладку Network в инструментах браузера для разработчиков. 
   2. Открой вкладку Cookies для первого GET-реквеста в списке.
   3. Скопируй csrftoken и sessionid, сохрани их в .env следующим образом:
   ```
   CSRF_TOKEN=...
   SESSION_ID=...
   ```
3. Телеграм-бот: обратись к @BotFather, создай бота и получи токен. Сохрани его в .env под названием ```TG_TOKEN```.
4. Твой id в телеграме. Его можно получить, отправив сообщение и прочитав update собственного бота, 
или воспользовавшись [userinfobot](https://github.com/nadam/userinfobot).
Сохрани свой id в .env под названием `TG_USER_ID`.

### Виртуальное окружение
Создай виртуальное окружение в корневом каталоге проекта и установи библиотеки:
```console
python3 -m venv venv
. venv/bin/activate
python3 -m pip install -r requirements.txt
```

## Как пользоваться
Из виртуального окружения запусти скрипт new_devman_alert.py, 
передав в качестве аргумента ссылку на урок, который ты только что отправил на проверку.
```console
(venv) .../review-alerts$ python3 new_devman_alert.py https://dvmn.org/modules/web-api/lesson/weather/
```
Этот скрипт добавляет команду в crontab, чтобы проверять статус урока каждые 20 минут с 7:00 до 23:00. 
Из crontab будет вызываться скрипт check_review_status.py с правильными аргументами для твоего урока.

## Как пользоваться при помощи быстрой команды
Неудобно каждый раз заходить в venv или прописывать полный путь до `review-alerts/venv/bin/python3`. 
Мы хотим, чтобы скрипт вызывался простой командой из любой директории. Для этого мы создадим alias в файле 
`~/.bashrc`.
1. Открой .bashrc в текстовом редакторе:
   ```console
   $ sudo nano ~/.bashrc
   ```
2. Добавь следующий текст в конце файла:
   ```bash
   # Custom aliases
   alias devman-alert='/путь/к/проекту/review-alerts/venv/bin/python3 /путь/к/проекту/review-alerts/old_new_devman_alert.py'
   ```
3. Перезапусти терминал, чтобы изменения вступили в силу, 
или обнови переменные окружения командой:
   ```console
   $ . ~/.bashrc
   ```
4. Готово! Теперь ты можешь создать новое уведомление из любого места на компьютере:
   ```console
   $ devman-alert https://dvmn.org/modules/web-api/lesson/weather/
   ```

## О проекте
Замечания и предложения приветствуются в телеграме: @pavelXmavel.
